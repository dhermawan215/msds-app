var Index=function(){var csrf_token=$('meta[name="csrf_token"]').attr("content"),table,aSelected=[];const moduleName="company";var handleDataTable=function(){table=$("#tbl-company").DataTable({responsive:!0,autoWidth:!0,dom:"Bfrtip",buttons:["pageLength","csv","excel","pdf","print"],searching:!0,paging:!0,lengthMenu:[[15,25,50],[15,25,50]],language:{info:"Show _START_ - _END_ from _TOTAL_ data",infoEmpty:"Show 0 - 0 from 0 data",infoFiltered:"",zeroRecords:"Data not found",loadingRecords:"Loading...",processing:"Processing..."},columnsDefs:[{searchable:!1,target:[0,1]},{orderable:!1,target:0}],processing:!0,serverSide:!0,ajax:{url:url+"/admin/company/list",type:"POST",data:{_token:csrf_token}},columns:[{data:"cbox",orderable:!1},{data:"rnum",orderable:!1},{data:"logo",orderable:!1},{data:"name",orderable:!1},{data:"action",orderable:!1}],drawCallback:function(settings){$(".data-menu-cbox").on("click",(function(){handleAddDeleteAselected($(this).val(),$(this).parents()[1])})),$("#btn-delete").attr("disabled",""),aSelected.splice(0,aSelected.length)}}),$("#btnRefresh").click((function(e){e.preventDefault(),table.ajax.reload()})),-1!==$.inArray("add",ModuleFn)?$("#btn-add").removeClass("disabled"):$("#btn-add").addClass("disabled")},handleAddDeleteAselected=function(value,parentElement){var check_value=$.inArray(value,aSelected);-1!==check_value?($(parentElement).removeClass("table-dark"),aSelected.splice(check_value,1)):($(parentElement).addClass("table-dark"),aSelected.push(value)),handleBtnDisableEnable()},handleBtnDisableEnable=function(){aSelected.length>0?$("#btn-delete").removeAttr("disabled"):$("#btn-delete").attr("disabled","")},handleEdit=function(){$(document).on("click",".btn-edit",(function(){var dataEdit=$(this).data("edit");$.ajax({type:"POST",url:url+"/admin/company/show",data:{_token:csrf_token,sVal:dataEdit},dataType:"json",success:function(response){let responseData=response.data;$("#company-name-edit").val(responseData.name),$("#phone-edit").val(responseData.phone),$("#address-edit").val(responseData.address)}}),handleUpdate(dataEdit)}))},handleChangeLogo=function(){$(document).on("click",".btn-change-logo",(function(){var dataChangeLogo=$(this).data("change");handleUpdateLogo(dataChangeLogo)}))},handleDetail=function(param){$(document).on("click",".btn-detail",(function(){var dataDetail=$(this).data("detail");$.ajax({type:"POST",url:url+"/admin/company/show",data:{_token:csrf_token,sVal:dataDetail},dataType:"json",success:function(response){let responseData=response.data;$("#company-name-detail").val(responseData.name),$("#phone-detail").val(responseData.phone),$("#address-detail").val(responseData.address)}})}))},handleDelete=function(){$("#btn-delete").click((function(e){e.preventDefault(),Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(result=>{result.isConfirmed&&$.ajax({type:"POST",url:url+"/admin/company/delete",data:{_token:csrf_token,dValue:aSelected},success:function(response){1==response.success&&(Swal.fire("Deleted!","Your file has been deleted.","success"),setTimeout(()=>{window.location.reload()},2500))},error:function(response){Swal.fire({icon:"error",title:"Oops...",text:"Internal Server Error"})}})})}))},handleAdd=function(){$("#form-add-company").submit((function(e){e.preventDefault();const form=$(this);let formData=new FormData(form[0]);confirm("is right?")&&$.ajax({url:`${url}/admin/company/save`,type:"POST",data:formData,processData:!1,contentType:!1,success:function(responses){toastr.success(responses.message),setTimeout(()=>{window.location.reload()},2500)},error:function(response){$.each(response.responseJSON,(function(key,value){toastr.error(value)}))}})}))},handleUpdate=function(idEdit){$("#form-edit-company").submit((function(e){e.preventDefault();const form=$(this);let formData=new FormData(form[0]);formData.append("formValue",idEdit),confirm("is right?")&&$.ajax({url:`${url}/admin/company/update`,type:"POST",data:formData,processData:!1,contentType:!1,success:function(responses){toastr.success(responses.message),setTimeout(()=>{window.location.reload()},2500)},error:function(response){$.each(response.responseJSON,(function(key,value){toastr.error(value)}))}})}))},handleUpdateLogo=function(idChangeLogo){$("#form-change-logo-company").submit((function(e){e.preventDefault();const form=$(this);let formData=new FormData(form[0]);formData.append("formValue",idChangeLogo),confirm("is right?")&&$.ajax({url:`${url}/admin/company/update-logo`,type:"POST",data:formData,processData:!1,contentType:!1,success:function(responses){toastr.success(responses.message),setTimeout(()=>{window.location.reload()},2500)},error:function(response){$.each(response.responseJSON,(function(key,value){toastr.error(value)}))}})}))};return{init:function(){handleDataTable(),handleDelete(),handleAdd(),handleDetail(),handleEdit(),handleChangeLogo()}}}();$(document).ready((function(){Index.init()}));